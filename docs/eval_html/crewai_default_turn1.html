<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Three.js Rotating Icosahedron (Wireframe)</title>
  <style>
    html, body { height: 100%; }
    body {
      margin: 0;
      overflow: hidden;
      background: #0a0a0a;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }
    #hud{
      position: fixed;
      left: 12px;
      bottom: 12px;
      color: rgba(255,255,255,0.75);
      font-size: 12px;
      line-height: 1.3;
      user-select: none;
      pointer-events: none;
      letter-spacing: 0.2px;
    }
    #hud b { color: rgba(255,255,255,0.9); font-weight: 600; }
    canvas { display: block; }
  </style>

  <script type="importmap">
  {
    "imports": {
      "three": "https://unpkg.com/three@0.170.0/build/three.module.js",
      "three/addons/": "https://unpkg.com/three@0.170.0/examples/jsm/"
    }
  }
  </script>
</head>

<body>
  <div id="hud">
    <b>Drag</b>: orbit · <b>Wheel</b>: zoom · <b>Shift+Drag</b>: pan<br>
    <b>Click</b>: toggle auto-rotate
  </div>

  <script type="module">
    import * as THREE from 'three';
    import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

    // Scene
    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x0a0a0a);
    scene.fog = new THREE.Fog(0x0a0a0a, 8, 22);

    // Camera
    const camera = new THREE.PerspectiveCamera(55, innerWidth / innerHeight, 0.1, 100);
    camera.position.set(0, 1.2, 6);

    // Renderer
    const renderer = new THREE.WebGLRenderer({ antialias: true, powerPreference: 'high-performance' });
    renderer.setSize(innerWidth, innerHeight);
    renderer.setPixelRatio(Math.min(devicePixelRatio, 2));
    document.body.appendChild(renderer.domElement);

    // Controls
    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.06;
    controls.autoRotate = true;
    controls.autoRotateSpeed = 1.2;

    // Lights (subtle, mostly for a tiny bit of depth with lines)
    scene.add(new THREE.AmbientLight(0xffffff, 0.25));
    const dir = new THREE.DirectionalLight(0xffffff, 0.6);
    dir.position.set(3, 5, 2);
    scene.add(dir);

    // Icosahedron wireframe
    const geometry = new THREE.IcosahedronGeometry(1.55, 0);
    const material = new THREE.MeshBasicMaterial({
      color: 0x78a6ff,
      wireframe: true
    });
    const ico = new THREE.Mesh(geometry, material);
    scene.add(ico);

    // Add a faint "halo" by drawing edges on top (optional but nice)
    const edges = new THREE.EdgesGeometry(geometry, 18);
    const lineMat = new THREE.LineBasicMaterial({ color: 0xcfe0ff, transparent: true, opacity: 0.35 });
    const outline = new THREE.LineSegments(edges, lineMat);
    ico.add(outline);

    // A subtle starfield-ish background (points), still dark
    const starCount = 1200;
    const starGeo = new THREE.BufferGeometry();
    const pos = new Float32Array(starCount * 3);
    for (let i = 0; i < starCount; i++) {
      const r = 8 + Math.random() * 18;
      const theta = Math.acos(THREE.MathUtils.randFloatSpread(2));
      const phi = THREE.MathUtils.randFloat(0, Math.PI * 2);
      pos[i * 3 + 0] = r * Math.sin(theta) * Math.cos(phi);
      pos[i * 3 + 1] = r * Math.cos(theta);
      pos[i * 3 + 2] = r * Math.sin(theta) * Math.sin(phi);
    }
    starGeo.setAttribute('position', new THREE.BufferAttribute(pos, 3));
    const stars = new THREE.Points(
      starGeo,
      new THREE.PointsMaterial({ color: 0x8aa0c7, size: 0.012, transparent: true, opacity: 0.65 })
    );
    scene.add(stars);

    // Interaction: click toggles auto-rotate
    window.addEventListener('pointerdown', (e) => {
      // avoid toggling when dragging (OrbitControls sets this flag internally)
      // simple heuristic: only toggle on primary button
      if (e.isPrimary) controls.autoRotate = !controls.autoRotate;
    });

    // Animation
    const clock = new THREE.Clock();
    function animate() {
      requestAnimationFrame(animate);
      const t = clock.getElapsedTime();

      // Gentle rotation even when autoRotate is off (very subtle) to keep it alive
      ico.rotation.x = t * 0.18;
      ico.rotation.y += 0.003;

      // Tiny breathing scale
      const s = 1.0 + Math.sin(t * 1.2) * 0.015;
      ico.scale.setScalar(s);

      // Parallax-ish drift for stars
      stars.rotation.y = t * 0.015;

      controls.update();
      renderer.render(scene, camera);
    }
    animate();

    // Resize
    window.addEventListener('resize', () => {
      camera.aspect = innerWidth / innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(innerWidth, innerHeight);
      renderer.setPixelRatio(Math.min(devicePixelRatio, 2));
    });
  </script>
</body>
</html>